<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="/assets/favicon.png"> <title>CDLNet: supplemental material</title> <header> <div class=blog-name ><a href="/">Nikola Janjušević</a></div> <nav> <ul> <li><a href="/teaching">Teaching</a> <li><a href="/publications">Publications</a> <li><a href="/notes">Notes</a> <li><a href="/assets/janjusevic_cv.pdf">CV</a> </ul> <img src="/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content > <h1 id=supplemental_material_for_cdlnet_noise-adaptive_convolutional_dictionary_learning_network_for_blind_denoising_and_demosaicing ><a href="#supplemental_material_for_cdlnet_noise-adaptive_convolutional_dictionary_learning_network_for_blind_denoising_and_demosaicing" class=header-anchor ><strong>Supplemental material for</strong> <em>CDLNet: Noise-Adaptive Convolutional Dictionary Learning Network for Blind Denoising and Demosaicing</em></a></h1> <h2 id=analysis_and_synthesis_dictionaries_bmak_bmbk ><a href="#analysis_and_synthesis_dictionaries_bmak_bmbk" class=header-anchor >Analysis and Synthesis dictionaries &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold-italic >A</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msup><mo separator=true >,</mo><mtext> </mtext><msup><mi mathvariant=bold-italic >B</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\bm{A}^{(k)}, \, \bm{B}^{(k)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.15845em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">A</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.96401em;"><span style="top:-3.13901em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.04835em;">B</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.96401em;"><span style="top:-3.13901em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>&#41; </a></h2> <p><em>How do the analysis and synthesis filters of CDLNet change over layers?</em> Below we look at the analysis <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold-italic >A</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\bm{A}^{(k)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.96401em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">A</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.96401em;"><span style="top:-3.13901em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> and synthesis dictionaries <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold-italic >B</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\bm{B}^{(k)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.96401em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.04835em;">B</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.96401em;"><span style="top:-3.13901em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> over the network layers, as well as the final synthesis dictionary <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >D</mi></mrow><annotation encoding="application/x-tex">\bm{D}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03194em;">D</span></span></span></span></span></span>. Networks with &#40;CDLNet&#41; and without &#40;CDLNet-B&#41; adaptive thresholds are shown.</p> <figure style="text-align:center;"> <img src="/assets/cdlnet_supp/CDLNet_s2030_ABfilters.apng" style="padding:0;width:60%; image-rendering:crisp-edges" alt=" CDLNet trained on noise-level range [20,30]. Analysis (A) (left) Synthesis (B) (middle) dictionaries of each layer.(right) Final synthesis dictionary (D)."/> <img src="/assets/cdlnet_supp/CDLNet_s2030_D.png" style="padding:0;width:30%; image-rendering:crisp-edges" alt=" CDLNet trained on noise-level range [20,30]. Analysis (A) (left) Synthesis (B) (middle) dictionaries of each layer.(right) Final synthesis dictionary (D)."/> <figcaption> CDLNet trained on noise-level range [20,30]. Analysis (A) (left) Synthesis (B) (middle) dictionaries of each layer.(right) Final synthesis dictionary (D).</figcaption> </figure> <figure style="text-align:center;"> <img src="/assets/cdlnet_supp/CDLNet-B_s2030_ABfilters.apng" style="padding:0;width:60%; image-rendering:crisp-edges" alt=" CDLNet-B trained on noise-level range [20,30]. Analysis (A) (left) Synthesis (B) (middle) dictionaries of each layer.(right) Final synthesis dictionary (D)."/> <img src="/assets/cdlnet_supp/CDLNet-B_s2030_D.png" style="padding:0;width:30%; image-rendering:crisp-edges" alt=" CDLNet-B trained on noise-level range [20,30]. Analysis (A) (left) Synthesis (B) (middle) dictionaries of each layer.(right) Final synthesis dictionary (D)."/> <figcaption> CDLNet-B trained on noise-level range [20,30]. Analysis (A) (left) Synthesis (B) (middle) dictionaries of each layer.(right) Final synthesis dictionary (D).</figcaption> </figure> <p>As we progress through the layers of the network, the analysis and synthesis dictionaries look more Gabor-like and converge closer to the final dictionary. Interestingly, the very first few layers of the network also show Gabor-like structures, in contrast to the more &quot;noisy&quot; filters in the intermediate layers.</p> <p>Further, we do not observe a significant difference between the dictionaries of CDLNet and CDLNet-B, suggesting that the generalization capability of CDLNet is solely a result of the noise-adaptive thresholds and not the learned intermediate representations.</p> <h2 id=learned_thresholds ><a href="#learned_thresholds" class=header-anchor >Learned Thresholds</a></h2> <p><em>How do the learned thresholds of CDLNet change over layers and subbands?</em> For the adaptive model, we have an affine relationship with the input noise-level &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>τ</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msup><mo>=</mo><msubsup><mi>τ</mi><mn>0</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>τ</mi><mn>1</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msubsup><mi>σ</mi></mrow><annotation encoding="application/x-tex">\tau^{(k)} = \tau^{(k)}_0 + \tau^{(k)}_1 \sigma</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8879999999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.26630799999999993em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.26630799999999993em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span>&#41;. For visualization purposes, we look at the thresholds for an input noise-level of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">\sigma=25</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >25</span></span></span></span>. We also show the thresholds of an equivalent model trained <em>without</em> adaptive thresholds &#40;CDLNet-B&#41;.</p> <p> <figure style="text-align:center;"> <img src="/assets/cdlnet_supp/CDLNet_s2030_tau.apng" style="padding:0; width:100%" alt=" CDLNet trained on noise-level range [20,30]. Thresholds vary with noise-level."/> <figcaption> CDLNet trained on noise-level range [20,30]. Thresholds vary with noise-level.</figcaption> </figure> <figure style="text-align:center;"> <img src="/assets/cdlnet_supp/CDLNet-B_s2030_tau.png" style="padding:0; width:100%" alt=" CDLNet-B trained on noise-level range [20,30]. Thresholds do not vary with noise-level."/> <figcaption> CDLNet-B trained on noise-level range [20,30]. Thresholds do not vary with noise-level.</figcaption> </figure> </p> <p>Note that the colorbars are not matched between the above two figures. For both adaptive and non-adaptive models, we see a general trend of thresholds increasing towards the final layers.</p> <h2 id=sparse_codes_bmzk_over_layers ><a href="#sparse_codes_bmzk_over_layers" class=header-anchor >Sparse codes &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold-italic >z</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo stretchy=false >)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\bm{z}^{(k)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8879999999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>&#41; over layers</a></h2> <p><em>How do the sparse codes of an input image vary over layers?</em> Below we show the magnitude of the sparse codes &#40;in layer <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>&#41; for the <code>cameraman</code> test image, for an input noise-level of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">\sigma=25</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >25</span></span></span></span>. </p> <figure style="text-align:center;"> <img src="/assets/cdlnet_supp/CDLNet_s2030_cameramanCSC.apng" style="padding:0; width:80%; image-rendering:crisp-edges" alt=" CDLNet trained on noise-level range [20,30]. Sparse codes (z) of cameraman image (noise-level 25)."/> <figcaption> CDLNet trained on noise-level range [20,30]. Sparse codes (z) of cameraman image (noise-level 25).</figcaption> </figure> <p>We observe that the representation becomes sparse in the final layers of the network, corresponding with the higher learned thresholds. Note that sparsity is not explicitly asked for during training &#40;there is no sparsity penalty in the loss function&#41;, but rather it is encoded through the use of the shrinkage-thresholding non-linearity &#40;derived from the basis-pursuit denoising formulation of the network&#41;.</p> <div class=page-foot > <div class=copyright > <!--<a href="https://github.com/nikopj">GitHub</a> <br> --> &copy; <a href="https://github.com/nikopj">Nikola Janjušević</a>. Last modified: 2025-04-26. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> + <a href="https://julialang.org">Julia</a>. </div> </div> </div>